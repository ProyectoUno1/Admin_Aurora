<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script type="module" src="ticketManagement.js"></script>
  <link rel="stylesheet" href="adminDashboard.css">
  <link rel="stylesheet" href="ticketManagement.css">
  <title>Gestión de Tickets - Aurora Admin</title>
</head>

<body>
  <div class="app-shell">
    <aside class="sidebar" aria-label="Sidebar">
      <div class="sidebar-brand">
        <h2>Aurora</h2>
      </div>
      <nav class="sidebar-nav">
        <a class="nav-item" href="adminDashboard.html">
          <span class="icon">
            <svg viewBox="0 0 24 24">
              <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
            </svg>
          </span>
          Dashboard
        </a>
        <a class="nav-item" href="psychologistManagement.html">
          <span class="icon">
            <svg viewBox="0 0 24 24">
              <path
                d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" />
            </svg>
          </span>
          Psicólogos
        </a>
        <a class="nav-item" href="patientManagement.html">
          <span class="icon">
            <svg viewBox="0 0 24 24">
              <path
                d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
            </svg>
          </span>
          Pacientes
        </a>
        <a class="nav-item" href="articleManagement.html">
          <span class="icon">
            <svg viewBox="0 0 24 24">
              <path
                d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
            </svg>
          </span>
          Artículos
        </a>
        <a class="nav-item" href="appointmentManagement.html">
          <span class="icon">
            <svg viewBox="0 0 24 24">
              <path
                d="M17 12h-3V7c0-.55-.45-1-1-1s-1 .45-1 1v5h-3c-.55 0-1 .45-1 1s.45 1 1 1h3v3c0 .55.45 1 1 1s1-.45 1-1v-3h3c.55 0 1-.45 1-1s-.45-1-1-1zM20 5c0-1.1-.9-2-2-2h-3.17c-.57-1.16-1.76-2-3.83-2s-3.26.84-3.83 2H6c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5zm-2 16H6V5h12v16z" />
            </svg>
          </span>
          Citas
        </a>
        <a class="nav-item active" href="ticketManagement.html">
          <span class="icon">
            <svg viewBox="0 0 24 24">
              <path
                d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z" />
            </svg>
          </span>
          Soporte
        </a>
        <a class="nav-item" href="statisticsManagement.html">
          <span class="icon">
            <svg viewBox="0 0 24 24">
              <path
                d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z" />
            </svg>
          </span>
          Estadísticas
        </a>
      </nav>
    </aside>

    <div class="main">
      <header class="main-header">
        <div class="header-content">
          <h1>Gestión de Tickets de Soporte</h1>
          <p class="subtitle">Administra y responde solicitudes de usuarios</p>
        </div>
        <div class="header-right">
          <div class="user-info">
            <span class="user-email" id="userEmail">admin@aurora.com</span>
            <span class="user-role">Administrador</span>
          </div>
          <button class="btn logout" onclick="logout()">Cerrar Sesión</button>
        </div>
      </header>

      <main class="content">
        <div id="loading" class="loading">
          <div class="spinner"></div>
          <p>Cargando tickets...</p>
        </div>

        <div id="ticketDashboard" style="display: none;">
          <!-- Stats Cards -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">
                <svg viewBox="0 0 24 24">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                </svg>
              </div>
              <div class="stat-info">
                <div class="stat-number" id="totalTickets">0</div>
                <div class="stat-label">Total de Tickets</div>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon" style="background: rgba(255, 152, 0, 0.1);">
                <svg viewBox="0 0 24 24" style="fill: #ff9800;">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" />
                </svg>
              </div>
              <div class="stat-info">
                <div class="stat-number" id="openTickets">0</div>
                <div class="stat-label">Abiertos</div>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon" style="background: rgba(33, 150, 243, 0.1);">
                <svg viewBox="0 0 24 24" style="fill: #2196f3;">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                </svg>
              </div>
              <div class="stat-info">
                <div class="stat-number" id="inProgressTickets">0</div>
                <div class="stat-label">En Proceso</div>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon" style="background: rgba(76, 175, 80, 0.1);">
                <svg viewBox="0 0 24 24" style="fill: #4caf50;">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                </svg>
              </div>
              <div class="stat-info">
                <div class="stat-number" id="resolvedTickets">0</div>
                <div class="stat-label">Resueltos</div>
              </div>
            </div>
          </div>

          <!-- Filters -->
          <div class="filters-section">
            <div class="filter-group">
              <label>Estado:</label>
              <select id="statusFilter" class="filter-select">
                <option value="">Todos</option>
                <option value="open">Abiertos</option>
                <option value="in_progress">En Proceso</option>
                <option value="resolved">Resueltos</option>
                <option value="closed">Cerrados</option>
              </select>
            </div>

            <div class="filter-group">
              <label>Prioridad:</label>
              <select id="priorityFilter" class="filter-select">
                <option value="">Todas</option>
                <option value="high">Alta</option>
                <option value="medium">Media</option>
                <option value="low">Baja</option>
              </select>
            </div>

            <div class="filter-group">
              <label>Categoría:</label>
              <select id="categoryFilter" class="filter-select">
                <option value="">Todas</option>
                <option value="technical">Técnico</option>
                <option value="billing">Facturación</option>
                <option value="general">General</option>
                <option value="complaint">Queja</option>
              </select>
            </div>

            <button class="btn-refresh" onclick="window.loadTickets()">
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" />
              </svg>
              Actualizar
            </button>
          </div>

          <!-- Tickets Table -->
          <div class="table-container">
            <table class="tickets-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Usuario</th>
                  <th>Asunto</th>
                  <th>Categoría</th>
                  <th>Prioridad</th>
                  <th>Estado</th>
                  <th>Fecha</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="ticketsTableBody">
                <!-- Tickets will be loaded here -->
              </tbody>
            </table>
          </div>

          <!-- Empty State -->
          <div id="emptyState" class="empty-state" style="display: none;">
            <svg viewBox="0 0 24 24" width="64" height="64" fill="#ccc">
              <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z" />
            </svg>
            <p>No se encontraron tickets</p>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- Modal para ver/responder ticket -->
  <div id="ticketModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Detalle del Ticket</h2>
        <button class="modal-close" onclick="closeTicketModal()">&times;</button>
      </div>
      <div class="modal-body" id="ticketModalBody">
        <!-- Ticket details will be loaded here -->
      </div>
    </div>
  </div>

</body>

</html>